<system label="roaming_selection">

    <VARS>

        <VAR label="pdu_session_establishment_requested">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="process_initiated">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="sm_context_request">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="sm_context_request_success">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="sm_context_response">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="sm_context_response_success">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="n4_session_request">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="n4_session_request_success">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="n4_session_response">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="n4_session_response_success">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="nsmf_pdu_session_request">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="nsmf_pdu_session_response_success">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="n2_sm_info">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>        

        <VAR label="nsmf_pdu_session_response">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="nsmf_message_transfer">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="n2_pdu_session_request">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="namf_success">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>        

        <VAR label="n2_pdu_session_request_success">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="n2_pdu_session_ACK">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="n2_pdu_session_ACKed">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="data_sent_up">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="data_done_processing">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="user_info_failure">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="data_received_ue">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        



        <VAR label="release_initiated">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>        

        <VAR label="pdu_release_requested">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="home_plmn_release_response">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="home_plmn_info">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="SMF_PCF_AMF_init">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="n2_resource_release_request">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="release_command_issued">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="pdu_update_sm_context">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="vsmf_release_response">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="hsmf_policy_release">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="hsmf_context_removal">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="ue_initiated_release">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>

        <VAR label="pdu_session_released">
            <datatype>boolean</datatype>
            <controltype>state</controltype>
            <possiblevalues>TRUE,FALSE</possiblevalues>
            <initialvalue>FALSE</initialvalue>
        </VAR>

        <VAR label="case_3_activation">
            <datatype>boolean</datatype>
            <controltype> environment </controltype>
            <fsm>visited_plmn</fsm>
        </VAR>




    </VARS>

    <FSMs>
        <FSM label="visited_plmn">

            <states>
                <state>no_session</state>
                <state>session_establishment_requested</state>
                <state>sm_context_requested</state>
                <state>sm_context_complete</state>
                <state>n4_session_requested</state>
                <state>n4_session_complete</state>
                <state>nsmf_pdu_requested</state>
                <state>nsmf_pdu_complete</state>
                <state>namf_message_transfer</state>
                <state>n2_pdu_requested</state>
                <state>session_establishment_successful</state>
                <state>data_sent_upstream</state>
                <state>data_processed_and_charged</state>
                <state>normal_session</state>

                <state>session_release</state>
                <state>home_response</state>
                <state>n2_resource</state>
                <state>ue_received_release</state>
                <state>pdu_update_sm</state>
                <state>vsmf_release</state>
                <state>hsmf_policy_removal</state>
                <state>hsmf_context_release</state>

            </states>

            <init_state>no_session</init_state>

            
            <transitions>
                <transition label="release_T1">
                    <start>vsmf_release</start>
                    <end>hsmf_context_release</end>

                    <condition>
                        ue_initiated_release
                    </condition>

                    <actions>
                        <action label="hsmf_context_deletion">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="hsmf_context_removal = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="release_T2">
                    <start>ue_received_release</start>
                    <end>vsmf_release</end>

                    <condition>
                        case_3_activation
                    </condition>

                    <actions>
                        <action label="normal_release">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="hsmf_policy_release = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="release_T3">
                    <start>home_response</start>
                    <end>vsmf_release</end>

                    <condition>
                        SMF_PCF_AMF_init
                    </condition>

                    <actions>
                        <action label="branch">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="hsmf_policy_release = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="release_T4">
                    <start>hsmf_context_release</start>
                    <end>no_session</end>

                    <condition>
                        pdu_session_released
                    </condition>

                    <actions>
                        <action label="release_completion">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="release_T5">
                    <start>hsmf_policy_removal</start>
                    <end>hsmf_context_release</end>

                    <condition>
                        hsmf_context_removal
                    </condition>

                    <actions>
                        <action label="hsmf_context_removing">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="pdu_session_released = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="release_T6">
                    <start>vsmf_release</start>
                    <end>hsmf_policy_removal</end>

                    <condition>
                        hsmf_policy_release
                    </condition>

                    <actions>
                        <action label="hsmf_policy_removing">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="hsmf_context_removal = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="release_T7">
                    <start>pdu_update_sm</start>
                    <end>vsmf_release</end>

                    <condition>
                        vsmf_release_response
                    </condition>

                    <actions>
                        <action label="vsmf_release_process">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="hsmf_policy_release = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="release_T8">
                    <start>ue_received_release</start>
                    <end>pdu_update_sm</end>

                    <condition>
                        pdu_update_sm_context
                    </condition>

                    <actions>
                        <action label="pdu_update_sm_context_release">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="vsmf_release_response = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="release_T9">
                    <start>n2_resource</start>
                    <end>ue_received_release</end>

                    <condition>
                        release_command_issued
                    </condition>

                    <actions>
                        <action label="ue_release_command">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="pdu_update_sm_context = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="release_T10">
                    <start>home_response</start>
                    <end>n2_resource</end>

                    <condition>
                        n2_resource_release_request &amp; !SMF_PCF_AMF_init
                    </condition>

                    <actions>
                        <action label="pinging_home">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="release_command_issued = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="release_T11">
                    <start>session_release</start>
                    <end>home_response</end>

                    <condition>
                        release_initiated
                    </condition>

                    <actions>
                        <action label="fork">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="n2_resource_release_request = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="release_T12">
                    <start>normal_session</start>
                    <end>session_release</end>

                    <condition>
                        pdu_release_requested
                    </condition>

                    <actions>
                        <action label="starting_release">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="home_plmn_release_response = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="data_received_ue = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="release_initiated = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>



                <transition label="T1_T13">
                    <start>no_session</start>
                    <end>session_establishment_requested</end>

                    <condition>
                        pdu_session_establishment_requested
                    </condition>

                    <actions>
                        <action label="establish_request">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="process_initiated = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="T2_T14">
                    <start>session_establishment_requested</start>
                    <end>sm_context_requested</end>

                    <condition>
                        process_initiated &amp; sm_context_request_success
                    </condition>

                    <actions>
                        <action label="send_sm_context_request">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="sm_context_request = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="T3_T15">
                    <start>sm_context_requested</start>
                    <end>sm_context_complete</end>

                    <condition>
                        sm_context_request &amp; sm_context_response_success
                    </condition>

                    <actions>
                        <action label="rcv_sm_context_response">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="sm_context_response = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="failure_T16">
                    <start>no_session</start>
                    <end>no_session</end>

                    <condition>
                        !process_initiated
                    </condition>

                    <actions>
                        <action label="null_action">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="T4_T17">
                    <start>sm_context_complete</start>
                    <end>n4_session_requested</end>

                    <condition>
                        sm_context_response &amp; n4_session_request_success
                    </condition>

                    <actions>
                        <action label="send_n4_request">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="n4_session_request = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="T5_T18">
                    <start>n4_session_requested</start>
                    <end>n4_session_complete</end>

                    <condition>
                        n4_session_request &amp; n4_session_response_success
                    </condition>

                    <actions>
                        <action label="rcv_n4_response">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="n4_session_response = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="T6_T19">
                    <start>n4_session_complete</start>
                    <end>nsmf_pdu_requested</end>

                    <condition>
                        n4_session_response
                    </condition>

                    <actions>
                        <action label="request_nsm_pdu">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="nsmf_pdu_session_request = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="T7_T20">
                    <start>nsmf_pdu_requested</start>
                    <end>nsmf_pdu_complete</end>

                    <condition>
                        nsmf_pdu_session_request &amp; nsmf_pdu_session_response_success
                    </condition>

                    <actions>
                        <action label="rcv_nsm_pdu_response">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="nsmf_pdu_session_response = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="T7_T21">
                    <start>nsmf_pdu_complete</start>
                    <end>namf_message_transfer</end>

                    <condition>
                        nsmf_pdu_session_request &amp; nsmf_pdu_session_response_success
                    </condition>

                    <actions>
                        <action label="rcv_nsm_pdu_response">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="nsmf_pdu_session_response = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="success_T22">
                    <start>namf_message_transfer</start>
                    <end>n2_pdu_requested</end>

                    <condition>
                        nsmf_pdu_session_response &amp; nsmf_message_transfer &amp; n2_pdu_session_request_success &amp; namf_success &amp; n2_sm_info
                    </condition>

                    <actions>
                        <action label="request_n2_pdu">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="n2_pdu_session_request = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="success_T23">
                    <start>session_establishment_successful</start>
                    <end>session_establishment_successful</end>

                    <condition>
                        !n2_sm_info
                    </condition>

                    <actions>
                        <action label="no_n2_sm_info">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="failed_T24">
                    <start>namf_message_transfer</start>
                    <end>no_session</end>

                    <condition>
                        nsmf_pdu_session_response &amp; nsmf_message_transfer &amp; n2_pdu_session_request_success &amp; !namf_success
                    </condition>

                    <actions>
                        <action label="request_n2_pdu">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="n2_pdu_session_request = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="T9_T25">
                    <start>n2_pdu_requested</start>
                    <end>session_establishment_successful</end>

                    <condition>
                        n2_pdu_session_request &amp; n2_pdu_session_ACKed
                    </condition>

                    <actions>
                        <action label="n2_request_acked">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="n2_pdu_session_ACK = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="data_T26">
                    <start>session_establishment_successful</start>
                    <end>data_sent_upstream</end>

                    <condition>
                        n2_pdu_session_ACK
                    </condition>

                    <actions>
                        <action label="data_sent">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="data_sent_up = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="data_T27">
                    <start>data_sent_upstream</start>
                    <end>data_processed_and_charged</end>

                    <condition>
                        data_sent_up
                    </condition>

                    <actions>
                        <action label="data_processing">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                        <action label="data_done_processing = TRUE">
                            <channel label="internal">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="user_T28">
                    <start>data_processed_and_charged</start>
                    <end>normal_session</end>

                    <condition>
                        data_done_processing &amp; !user_info_failure
                    </condition>

                    <actions>
                        <action label="data_process_good">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

                <transition label="late_T29">
                    <start>data_processed_and_charged</start>
                    <end>no_session</end>

                    <condition>
                        user_info_failure
                    </condition>

                    <actions>
                        <action label="data_processing_fail">
                            <channel label="PLMN">
                            <start> visited_plmn </start>
                            <end> visited_plmn </end>
                            </channel>
                        </action>
                    </actions>
                </transition>

            </transitions>

        </FSM>
    </FSMs>

</system>